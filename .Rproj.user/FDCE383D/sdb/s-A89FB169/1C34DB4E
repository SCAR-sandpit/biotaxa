{
    "collab_server" : "",
    "contents" : "#install.packages(\"RJSONIO\")\n#install.packages(\"RCurl\")\nlibrary(\"RJSONIO\")\nlibrary(\"RCurl\")\n\n#all_data <- getURL(\"http://api.gbif.org/v1/dataset\")\n#data <- fromJSON(all_data)\n#length(data)\n\nsetwd(\"/Users/hhsieh/Documents/ANTABIS/RASp/RAS species list/Lists for references matches/Lists for references matches in csv files\")\ndata <- read.csv(\"1_GBIF_worms_irmng_unmatched.csv\", header = T, sep = \",\")\ndim(data)\nhead(data)\nkeys <- data$GBIF_datasource\n\nd2 <- read.csv(\"2_gbif_genus_matchedbyworms.csv\", header = T, sep = \",\")\nkeys2 <- d2$GBIF_datasource\nd3 <- read.csv(\"3_gbif_unmatchedbyworms_matchedbyirmng.csv\", header = T, sep = \",\")\nkeys3 <- d3$GBIF_datasource\n\ngetCitation <- function(key) {\n  durl <- paste(\"http://api.gbif.org/v1/dataset/\", key, sep = \"\")\n  if(durl != \"http://api.gbif.org/v1/dataset/NA\") {\n    res <- fromJSON(durl)\n    res$citation\n  } else {\n    res = \"\"\n    res\n  }\n}\n\ncitations <- lapply(keys, getCitation)\ncitations2 <- lapply(keys2, getCitation)\ncitations3 <- lapply(keys3, getCitation)\n\ncitations <- as.character(citations)\ncitations2 <- as.character(citations2)\ncitations3 <- as.character(citations3)\n\ndistiller <- function(citation) {\n  strsplit(citation, split = \" Occurrence Dataset\", fixed = TRUE)[[1]][1]\n}\n\ncitations_distilled <- lapply(citations, distiller)\ncitations_distilled2 <- lapply(citations2, distiller)\ncitations_distilled3 <- lapply(citations3, distiller)\n\ncitations_distilled <- unlist(citations_distilled)\ncitations_distilled2 <- unlist(citations_distilled2)\ncitations_distilled3 <- unlist(citations_distilled3)\n\nwrite.csv(citations_distilled, \"citations_distilled.csv\", row.names = FALSE)\nwrite.csv(citations_distilled2, \"citations_distilled2.csv\", row.names = FALSE)\nwrite.csv(citations_distilled3, \"citations_distilled3.csv\", row.names = FALSE)\n\nnewd1 <- cbind(data, citations_distilled)\ncolnames(newd1)[17] <- \"citation_GBIF\"\ncolnames(newd1)\nnewd2 <- cbind(d2, citations_distilled2)\ncolnames(newd2)[33] <- \"citation_GBIF\"\ncolnames(newd2)\nnewd3 <- cbind(d3, citations_distilled3)\ncolnames(newd3)[31] <- \"citation_GBIF\"\ncolnames(newd3)\n\nwrite.csv(newd1, \"1_GBIF_worms_irmng_unmatched.xls\", row.names = FALSE)\nwrite.csv(newd2, \"2_gbif_genus_matchedbyworms.xls\", row.names = FALSE)\nwrite.csv(newd3, \"3_gbif_unmatchedbyworms_matchedbyirmng.xls\", row.names = FALSE)\n\n\n\n\n",
    "created" : 1504724055634.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "54993442",
    "id" : "1C34DB4E",
    "lastKnownWriteTime" : 1504811962,
    "last_content_update" : 1504811962241,
    "path" : "~/Documents/ANTABIS/RASp/RAS species list/Lists for references matches/gettingGBIFCitations.R",
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled2"
    },
    "relative_order" : 9,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}